# naive reference implementation of DFT for comparison with janus FFT
import math
from matplotlib import pyplot as plt

def rotate(x, angle):
    s = math.sin(angle)
    c = math.cos(angle)
    return (c * x[0] - s * x[1], s * x[0] + c * x[1])

def add(x, y):
    return (x[0] + y[0], x[1] + y[1])

def sub(x, y):
    return (x[0] - y[0], x[1] - y[1])

def dft(signal):
    l = len(signal)
    result = [(0,0) for x in signal]

    for k in range(l):
        for n, x in zip(range(len(signal)), signal):
            result[k] = add(result[k], rotate(x, k * n / len(signal) * math.pi * 2))
    return result

def fft(signal):
    N = len(signal)
    halfN = N // 2
    if N == 1:
        return signal

    evens = [signal[2*n] for n in range(halfN)]
    odds = [signal[2*n + 1] for n in range(halfN)]

    evens = fft(evens)
    odds = fft(odds)

    for k in range(halfN):
        o = rotate(odds[k], 2 * math.pi * k/N)
        odds[k] = sub(evens[k], o)
        evens[k] = add(evens[k], o)

    return evens + odds


signal = [0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080,0,25080,46341,60547,65536,60547,46341,25080,0,-25080,-46341,-60547,-65536,-60547,-46341,-25080]
signal = [(s, 0) for s in signal]

result = fft(signal)
yr = [r for r, i in result]
yi = [i for r, i in result]

x = range(256)

y = [math.sqrt(r**2 + i**2) for r, i in zip(yr, yi)]
plt.plot(x, y)
plt.show()

ax = plt.axes(projection = '3d')
ax.set_proj_type('ortho')

ax.plot3D(x, yr, yi)
plt.show()
